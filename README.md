Code for NBTO as of Nov 2016.